<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Zyron Editor</title>
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com;">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app-wrapper">
        <div id="title-bar">
            <div id="title-label">Zyron</div>
            <div id="title-bar-buttons">
                <button id="minimize-btn" class="title-bar-btn">−</button>
                <button id="close-btn" class="title-bar-btn">✕</button>
            </div>
        </div>

        <div id="login-view">
            <div id="login-card">
                <h1>Welcome to Zyron</h1>
                <p>Please enter your name to continue.</p>
                <form id="login-form" style="display: flex; flex-direction: column; gap: 1rem;">
                    <input id="username-input" type="text" placeholder="Enter your name" class="form-input" required>
                    <button type="submit" class="btn">Continue</button>
                </form>
            </div>
        </div>

        <div id="main-app-view" class="hidden">
            <nav id="main-nav">
                <button id="nav-editor-btn" class="main-nav-btn active" title="Editor">
                    <img src="assets/images/editIcon.png" alt="Editor" class="nav-icon">
                    <span class="nav-label">Editor</span>
                </button>
                <button id="nav-scripts-btn" class="main-nav-btn" title="Scripts">
                    <img src="assets/images/scriptsIcon.png" alt="Scripts" class="nav-icon">
                    <span class="nav-label">Scripts</span>
                </button>
                <button id="nav-settings-btn" class="main-nav-btn" title="Settings">
                    <img src="assets/images/settingsIcon.png" alt="Settings" class="nav-icon">
                    <span class="nav-label">Settings</span>
                </button>
                <button id="nav-about-btn" class="main-nav-btn" title="About">
                    <img src="assets/images/aboutIcon.png" alt="About" class="nav-icon">
                    <span class="nav-label">About</span>
                </button>
            </nav>
            <div id="main-content">
                <div id="editor-pane" class="content-pane">
                    <div id="script-tab-container">
                        <div id="script-tab-bar">
                            <!-- Script tabs will be inserted here by JS -->
                        </div>
                        <input type="text" id="script-search-box" placeholder="Search scripts...">
                        <button id="new-tab-btn">+</button>
                    </div>
                    <div id="editor-area"></div>
                </div>
                <div id="scripts-pane" class="content-pane hidden">
                    <div class="scripts-header">
                        <h1>Here are scripts we recommend!</h1>
                        <div class="scripts-controls">
                            <div class="script-filter-buttons">
                                <button class="filter-btn active" data-filter="all">All</button>
                                <button class="filter-btn" data-filter="free">Free</button>
                                <button class="filter-btn" data-filter="paid">Paid</button>
                            </div>
                            <input type="text" id="script-hub-search" placeholder="Search scripts...">
                        </div>
                    </div>
                    <div id="script-cards-container">
                        <!-- Script cards will be loaded here -->
                    </div>
                </div>
                <div id="settings-pane" class="content-pane hidden">
                    <div style="width: 100%; max-width: 800px; margin: 0 auto; padding: 1rem;">
                        <div class="settings-section">
                            <h2>Visuals</h2>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h3>Performance Mode</h3>
                                    <p class="setting-description">Disables animations and transitions to improve performance on slower devices</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="performance-mode-toggle">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h2>Functionality</h2>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h3>Auto Save</h3>
                                    <p class="setting-description">Automatically saves your scripts every 30 seconds</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="auto-save-toggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h3>Discord Rich Presence</h3>
                                    <p class="setting-description">Shows your Zyron activity status on Discord</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="discord-rpc-toggle">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h3>Enable Notifications</h3>
                                    <p class="setting-description">Shows popup notifications for script execution and app events</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="notifications-toggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h3>Zexium API <span class="beta-label">BETA</span></h3>
                                    <p class="setting-description">Enable API connection between Zyron and Roblox for advanced features like Execute on Join and saved keys</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="zexium-api-toggle">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h2>Account & Data</h2>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h3>Change Name</h3>
                                    <p class="setting-description">Update your display name shown in the app</p>
                                </div>
                                <button id="rename-user-btn" class="btn">Rename</button>
                            </div>
                             <div class="setting-item">
                                <div class="setting-info">
                                    <h3>Clear App Data</h3>
                                    <p class="setting-description">Permanently delete all scripts, settings, and user data</p>
                                </div>
                                <button id="clear-data-btn" class="btn btn-danger">Clear Data</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="about-pane" class="content-pane hidden">
                    <img src="https://i.imgur.com/SZtzFrW.png" alt="Zexon Development Logo">
                    <h1>Zyron</h1>
                    <p style="text-align: center; color: var(--text-muted);" id="app-version"></p>
                    <p>Zexon Development is a private organization, branded as Zexon, that has created projects like Zyron, Zexon Script, and other Roblox Projects. Zexon and Zyron do not collect any data whatsoever. It only connects to Hydrogen and stores data on the user's device. Zyron is a custom UI for the Roblox Executor named Hydrogen. Zyron is not an executor itself but a layer; it connects to Hydrogen and can execute scripts for you, providing a premium user experience.</p>
                    
                    <h2>Changelog</h2>
                    <div id="changelog-container"></div>
                </div>
            </div>
            <div id="bottom-bar">
                <div id="connection-status">
                    <div class="connection-item">
                        <img src="assets/images/robloxIcon.png" class="connection-icon" alt="Roblox">
                        <span id="roblox-status-text">Disconnected</span>
                        <div id="roblox-status-indicator" class="status-indicator disconnected"></div>
                    </div>
                    <div class="connection-item">
                        <img src="assets/images/zexiumIcon.png" class="connection-icon" alt="Zexium">
                        <span id="zexium-status-text">Disabled</span>
                        <div id="zexium-status-indicator" class="status-indicator disconnected"></div>
                    </div>
                </div>
                <div id="user-display"></div>
                <button id="execute-btn" disabled>Execute</button>
            </div>
        </div>
    </div>

    <!-- Script Settings Modal -->
    <div id="script-settings-modal-overlay" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 id="script-settings-modal-title">Script Settings</h2>
            <div class="script-settings-content">
                <div class="setting-item">
                    <div class="setting-info">
                        <h3>Execute on Join</h3>
                        <p class="setting-description">Automatically execute this script when joining a Roblox game</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="execute-on-join-toggle">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item" id="set-key-setting" style="display: none;">
                    <div class="setting-info">
                        <h3>Key</h3>
                        <p class="setting-description">Script key (saved automatically when changed)</p>
                    </div>
                    <div class="key-input-container">
                        <input type="text" id="script-key-input" class="form-input" placeholder="Enter script key...">
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="script-settings-done" class="btn">Done</button>
            </div>
        </div>
    </div>

    <!-- Set Key Modal -->
    <div id="set-key-modal-overlay" class="modal-overlay hidden">
        <div class="modal-content">
            <h2>Set Script Key</h2>
            <p>Enter the key you want to be used when this script is executed</p>
            <p class="disclaimer">This key is stored locally on your device only and is not shared with us.</p>
            <input id="key-input" type="text" class="form-input" placeholder="Enter your key here...">
            <div class="modal-actions">
                <button id="set-key-cancel" class="btn btn-secondary">Cancel</button>
                <button id="set-key-save" class="btn">Save Key</button>
            </div>
        </div>
    </div>

    <div id="context-menu" class="hidden">
        <button class="context-menu-item" id="rename-tab-btn">Rename</button>
        <button class="context-menu-item" id="cancel-context-btn">Cancel</button>
    </div>

    <div id="rename-modal-overlay" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 id="rename-modal-title">Rename</h2>
            <input id="rename-modal-input" type="text" class="form-input">
            <div class="modal-actions">
                <button id="rename-modal-cancel" class="btn btn-secondary">Cancel</button>
                <button id="rename-modal-save" class="btn">Save</button>
            </div>
        </div>
    </div>

    <div id="confirm-modal-overlay" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 id="confirm-modal-title">Are you sure?</h2>
            <p id="confirm-modal-text">This action cannot be undone.</p>
            <div class="modal-actions">
                <button id="confirm-modal-cancel" class="btn btn-secondary">Cancel</button>
                <button id="confirm-modal-confirm" class="btn btn-danger">Confirm</button>
            </div>
        </div>
    </div>

    <div id="notification-container"></div>

    <!-- Update Modal -->
    <div id="update-modal-overlay" class="modal-overlay hidden">
        <div class="modal-content update-modal">
            <h2>Update Available</h2>
            <p id="update-modal-text">A new version of Zyron is available. Would you like to install it now?</p>
            <div class="update-progress hidden" id="update-progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <p id="progress-text">Downloading update...</p>
            </div>
            <div class="modal-actions" id="update-modal-actions">
                <button id="update-modal-no" class="btn btn-secondary">Not Now</button>
                <button id="update-modal-yes" class="btn btn-primary">Install Update</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/theme-twilight.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/mode-lua.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ext-language_tools.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
